---
- name: G-PI Installer
  become: true

tasks:
  - name: Get aptitude
    apt:
      name: aptitude
      force_apt_get: yes

  - name: Get packages
    apt:
      pkg:
      - wiringpi
      - git
      - cmake
      state: latest

  - name: Get repo
    git:
      repo: "https://gitlab.fdmci.hva.nl/sfs-power-monitoring/powermonitoring.git"
      dest: powermonitoring
      recursive: yes

  - name: Run cmake
    command: cd powermonitoring; cmake .

  - name: Build targets
    make:
      chdir: powermonitoring
      target: all

